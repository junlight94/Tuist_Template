.PHONY: generate

module:
	@echo "âœ¨ ì„œë¹„ìŠ¤ ì„ íƒ:"
	@ls ./Projects | grep "Service" | nl -w2 -s'. '
	@read -p "ğŸ“ ì˜µì…˜ ì…ë ¥ (ì„œë¹„ìŠ¤ ëª¨ë“ˆì˜ ìˆ«ì ì„ íƒ): " path_option; \
	folder_count=$$(ls ./Projects | grep "Service" | wc -l); \
	if [ "$$path_option" -ge 1 ] && [ "$$path_option" -le "$$folder_count" ]; then \
		selected_service=$$(ls ./Projects | grep "Service" | sed -n "$${path_option}p"); \
		echo "âœ… ì„ íƒëœ ì„œë¹„ìŠ¤: $$selected_service"; \
	else \
		echo "âŒ ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤."; \
		exit 1; \
	fi; \
	echo "\n"; \
	echo "âœ¨ ëª¨ë“ˆ ì„ íƒ:"; \
	echo "[1]  Micro Feature ëª¨ë“ˆ ìƒì„±"; \
	echo "[2]  Domain ëª¨ë“ˆ ìƒì„±"; \
	read -p "ğŸ“ ì˜µì…˜ ì…ë ¥ (1, 2): " path_option; \
	case $$path_option in \
	1) \
		destination="Projects/$$selected_service/Features"; \
		folderName="feature";; \
	2) \
		destination="Projects/$$selected_service/Domains"; \
		folderName="domain";; \
	*) \
		echo "âŒ ì˜ëª»ëœ ì˜µì…˜ ì…ë ¥ì…ë‹ˆë‹¤. 1, 2 ì¤‘ì—ì„œ ì„ íƒí•˜ì„¸ìš”."; \
		exit 1;; \
	esac; \
	\
	echo "\n"; \
	echo "ğŸŒŸ ëª¨ë“ˆ ì´ë¦„ ì…ë ¥ ê·œì¹™:"; \
	echo "1ï¸âƒ£  'Feature', 'Domain'ëŠ” ìë™ìœ¼ë¡œ ë¶™ìŠµë‹ˆë‹¤! ì…ë ¥í•˜ì§€ ë§ˆì„¸ìš”."; \
	echo "-----------------------------------------------"; \
	\
	read -p "ğŸš€ ëª¨ë“ˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”: " name; \
	\
	if [ -z "$$name" ]; then \
		echo "âŒ ëª¨ë“ˆ ì´ë¦„ì„ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤!"; \
		exit 1; \
	fi; \
	if [ "$$folderName" = "domain" ]; then \
		sh ./Script/addNewDomain.sh "$$name" "$$selected_service"; \
	elif [ "$$folderName" = "feature" ]; then \
		sh ./Script/addNewFeature.sh "$$name" "$$selected_service"; \
	else \
		echo "ğŸš¨ Error: Unknown folderName '$$folderName'"; \
		exit 1; \
	fi; \
	echo "\n"
	echo "ğŸ”¨ ëª¨ë“ˆ ìƒì„±ì¤‘ì…ë‹ˆë‹¤"; \
	tuist scaffold "$$folderName" --name "$$name" --path "$$destination"
